(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1285:function(t,e,n){var content=n(1292);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(65).default)("5c33164c",content,!0,{sourceMap:!1})},1291:function(t,e,n){"use strict";n(1285)},1292:function(t,e,n){var r=n(64)((function(i){return i[1]}));r.push([t.i,"#GarbageModal .title[data-v-ba7985c6]{font-weight:800}#GarbageModal .trash-flex[data-v-ba7985c6]{display:flex;font-size:12px;font-weight:800;gap:14px;justify-content:center;margin-bottom:5px}#GarbageModal .trash-flex .trash-area[data-v-ba7985c6]{display:flex;flex-direction:column}#GarbageModal .trashIcon[data-v-ba7985c6]{font-size:25px}#GarbageModal .map-link[data-v-ba7985c6]{color:#1a73e8;padding-left:20px;text-align:center}",""]),r.locals={},t.exports=r},1299:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAtCAYAAAA3BJLdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGzSURBVHgB7ZnBUcMwEEW/k9wJR89wIB1QApRAB1ABlEAJlEIqgBLoAHGCG86NA1issDPjyGtrDZa98eTNZJJoFOfNer1eyQmEvAM39HZlgTP0xxO9rlPASCYnkklOlCTvEYfsG7g4AZ5DE2cQQKK3iMdyXpy1IEHZN+AUxWtLhv45l0xaoDsZ5dgx/kEZgBd0RJQGWjjIxiIpy9IdfV5CL4bK22VCyf4B3aK/UEDXLg3Uizro7nW0Xzlb/fLX+hcJQ/V8VR2YTukSdTk9YVH779ptfUfWb9X8AwyJDclqh5ON0VUF8VOOIrvx56iR9UmKm9UOatJAcn3UZBMlkc2BV3+sJmuVyHJwshuMQOc6W/4oaztILPxqkE+uzloldXbObHyorQYcwTQYK2c5ZsyAaZ0QCSYoxh+Y1lJ8rDbxU1K6vrzwD9mAV1lNrs4uhBu7kTHc4GGvqyuSJsZRk00VpIGVymqmSXbQNlGyWHSIZIeutdxi0SF6ppAjrrCLmOTssbLuarTewWLii3KLxUYP2mVeY0RI/oEbbzy7tP35COHzqb5JG7xaU5GE7ZBd11amSfYHwnBgZixOUB4AAAAASUVORK5CYII="},1300:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAtCAYAAAA3BJLdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAI6SURBVHgB7ZlLTiMxEIbrb3pG2U1mB5pN5gYEiQU7uAGcAG6AOACiIRfgBlwBTgAXgHADmhXsaFa8ki5sgRAuO4mb9MNBfAskG8f9p1xVruqAPOn1F9bBtM1EHSqJiOny5Zl3kpXb1Gc9fBYdnM9vRcARVUM2eOKuj+CIPACwR9XR/vWbvPafKDbpz3dgHD0yKpkcWPVZF1NhOFXHtkFTMBdTB3M4pYIUFqsCrO0bEKNQp0UxU2G8fDYUZkosev1/m8R5MnaRyK3qBFOa9sEF9sRbettA72LhCiUm+go5iWZEqIL/zJTPxgM8/KXHVlsPXPmPv5BivgI+/rw/V/nw8InXPiZaj5lRG+jbKmZcUQNom8Acp7tLN/8/rwnGDSBOUGcAucYQm3Snu5nKhceLDR2HWLOqqivA2KqscS9nLLHsMH8TgPlOzgUbYC4ssTIKvfqeEmAy1eZE13KNy7JBuIELW2xO99QIECNMTl0cmQHGdfkBpBsEnGfhYRVbLJvmR015VkYycrsYd1hWuAHVpXYys33dyl6oqW8zHHi5QbhMFMuoK3cJVGcgp+zr1orCZgIs6WbfrJ4dxtKy1bsB2+PUte7nXVdRfJpFjSU2jKaR/cSGzAixspasO33BWVM7xcqmkSsuauX2rmZR4/WaXu9VrW39nhCP+GgmJyq2rTFyNYsatxswn1CT5HTmmnaKHUatQ2XKS2oAZaj93eXbM9f/xp6u/hlUdZmLkXrrTBWT6wyQ8/EooZpXqNq56hdONQwAAAAASUVORK5CYII="},1309:function(t,e,n){"use strict";var r=n(45),o=(n(98),n(161),{name:"GarbageModal",props:{general:{type:Object,default:null},recycle:{type:Object,default:null},lat:{type:Number,default:null},lng:{type:Number,default:null},tname:{type:String,default:null}},data:function(){return{}},computed:{trashColor:function(){return function(t){return t<50?"#84ce19":t<75?"#ece200":t<=90?"#e70000":t<=100?"#a005d7":"#000000"}}},methods:{toGoogleMap:function(){console.log(Object(r.a)(this.lat),this.lng),window.open("https://www.google.com/maps/dir/?api=1&destination=".concat(this.lat,",").concat(this.lng),"_blank")}}}),c=(n(1291),n(28)),component=Object(c.a)(o,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"GarbageModal"}},[e("p",[t._v(t._s(t.tname))]),e("div",{staticClass:"trash-flex"},[e("div",{staticClass:"trash-area"},[e("p",[t._v(t._s("一般垃圾"))]),e("aIcon",{staticClass:"trashIcon",style:{color:t.trashColor(t.general.tcapacity)},attrs:{type:"delete",theme:"filled"}})],1),e("div",{staticClass:"trash-area"},[e("p",[t._v(t._s("回收垃圾"))]),e("aIcon",{staticClass:"trashIcon",style:{color:t.trashColor(t.recycle.tcapacity)},attrs:{type:"delete",theme:"filled"}})],1)]),e("a",{staticClass:"map-link",on:{click:t.toGoogleMap}},[t._v(t._s("在Google 地圖上查看"))])])}),[],!1,null,"ba7985c6",null);e.a=component.exports},1323:function(t,e,n){t.exports=n.p+"img/connect.a3a25e3.png"},1324:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAtCAYAAAA3BJLdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAG/SURBVHgB7ZlBTsJAFIb/KZCwExJdsDH0BnoDPYlyAr2B8QbewCvICfQI3ICKCxOjocYNCcyMbwwu6Ax1sJ30teFLGmAyNH8m//s7ryPgydsMlxFwQV9P6OqhOCldk2UHo8EAic8fhM+ktdB7hCElwac+giN4QJNuEI5eR/rd/0+xr1MM6WOIkCic+UxrY3eSw2PEKIBZgE4LU+yIlw24sBcbCvHxgisy+HXeJC02C0xov1ws8Z6pVBiJ9xnmKCfkg6I1xsYG7IUahMBBrTzb/pLod9erS6E7FC08ggfJUuL898eCfLuxN/hvWAfCeviwtQEVVJod2xA7iItHUllQQeWL5Y5LbAoGkA0+s2OWWKF5iKVUmmfHam6DiIkNJJ6zY5ZYzcQGLmyxsI1dBRoe0cVmZRuXsxGTnBXSfpq6PFufAuOM/QQTPDYzq66HDTjDVmx34ZOzkocN+nHTcnYFFiubuAb3BVaUbfsTSyyHptHVLBoaYYNK9weuZtHgFFt10+hqFg0NsEHFTaOrWTQ4xSqFMapE4ck17BTbVrgj305QAVRct0exW2zucejPMaims1p664zQUAJohYdtQg3focmDedF7tAYAAAAASUVORK5CYII="},1325:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAtCAYAAAA3BJLdAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHeSURBVHgB7ZnNccIwEIV3jZnhFkqAI5ND0kI6SDrAFSSpIE4l4BLSAemAE+QWpwLIjRmCNxKneCXjJSBLMHwnRqxnnqWnpx8jCMnaH48E9KR+9uB4TAiK52R9PZUUo6Qoi+cvhJCCE3BJsLmTCI5AgBI6BGdQFxBTSWWt2FFn3oPjDr0BEt5I6mLYn3y4HvThAHQH4AY+YU9ENgiFi1hX4DY/qUjVjOxCuOQqjx9w3J4tlOaQhW4hpLfoFIRqVLxdKbG0hBOhtNz+N/8cYeT5OUWXaJ/jCDTsWRKbrAZ5+W8Cf9BusaFjEespHdggqlz95iUWsRhElCG1FrwtGBsQm8vq9BBwz/K5TCiZYOGuaIZYImbsptKLRzpKogvDmGBQYMA5S/VDGFkeKr1RYy5A5gOEnNcEm7M26m2AvmaYicUG5e7HxmzNOiUW2SBcasUSFuCFVUeSs8wG5GcDnkD/3PazFmN7ILc1Xu66Dse+MBlizUOjD0gmNmQqxPI3cxxfgsOipkIs90yz9we2w6JG9E2BtFiHiwNGKNrPVonN4c8XGtQ2cOkEJlRdbn/ZyqKKZ9/BJzGMbc1WscnPIFVDn4EHlNteq+Jz5+COWrN7dd64hSbQp1nCqeqoSVXJL6H7nPTOnkxoAAAAAElFTkSuQmCC"},1369:function(t,e,n){var content=n(1459);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(65).default)("e872769a",content,!0,{sourceMap:!1})},1457:function(t,e,n){t.exports=n.p+"img/garbage-truck.bc54441.png"},1458:function(t,e,n){"use strict";n(1369)},1459:function(t,e,n){var r=n(64)((function(i){return i[1]}));r.push([t.i,".google-map[data-v-dcb77a50]{height:90vh;width:100%}.img-mask[data-v-dcb77a50]{align-content:center;align-items:center;background-color:#343f3b;display:flex;flex-direction:row;flex-wrap:wrap;height:90vh;justify-content:center}.img-mask .img-text[data-v-dcb77a50]{color:#fff;font-size:22px}.img-mask .img-text-big[data-v-dcb77a50]{color:#fff;font-size:30px}.img-mask img[data-v-dcb77a50]{height:auto;width:100%}",""]),r.locals={},t.exports=r},1504:function(t,e,n){"use strict";n.r(e);var r=n(30),o=(n(129),n(24),n(34),n(35),n(46),n(88),n(99),n(100),n(87),n(101),n(66),n(40),n(50),n(51),function(){var t=Object(r.a)(regeneratorRuntime.mark((function t(e){var r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([n.e(1),n.e(2)]).then(n.bind(null,1274));case 2:return r=t.sent.default,t.prev=3,t.next=6,r.post("https://large-lovely-woodcock.ngrok-free.app/CleanerRespArea/?uname=".concat(e));case 6:return o=t.sent,t.abrupt("return",o);case 10:return t.prev=10,t.t0=t.catch(3),t.abrupt("return",{message:"更新資料完成",status:"success"});case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e){return t.apply(this,arguments)}}()),c=n(9),l=n(1309);function A(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){l=!0,o=t},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var d={name:"GarbageTruckData",components:{GarbageModal:function(){return n.e(8).then(n.bind(null,1536))},Loading:function(){return n.e(3).then(n.bind(null,1538))}},data:function(){return{loadingVisible:!1,isNoMap:!1,dateTime:"",marker:{position:{lat:10,lng:10}},visible:!1,map:null,currentLocation:{lat:null,lng:null},trashcanList:[],trashcan:[]}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingVisible=!0,e.next=3,t.getCurrentLocation();case 3:return e.next=5,t.Init();case 5:t.loadingVisible=!1,t.initMap(),r=n(1457),new google.maps.Marker({position:t.currentLocation,map:t.map,icon:{url:r,scaledSize:new google.maps.Size(60,60)}}),t.fetchtrashcan(),t.setMarker(),t.setGarbageMarker();case 12:case"end":return e.stop()}}),e)})))()},methods:{Init:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.GetStaffTrashListApi();case 2:case"end":return e.stop()}}),e)})))()},fetchtrashcan:function(){this.trashcan=this.trashcanList.trashcan,this.currentLocation.lat=null,this.currentLocation.lng=null},initMap:function(){this.map=new google.maps.Map(document.getElementById("mapStaff"),{center:{lat:this.currentLocation.lat,lng:this.currentLocation.lng},zoom:18,maxZoom:20,minZoom:10,streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!1,zoomControl:!1,styles:[{featureType:"poi.business",stylers:[{visibility:"off"}]}]})},setMarker:function(){var t=this;this.trashcan.forEach((function(e){var r=n(1299);r=e.General.tcapacity<50?n(1300):e.General.tcapacity<75?n(1324):e.General.tcapacity<=90?n(1299):e.General.tcapacity<=100?n(1325):n(1300);var marker=new google.maps.Marker({position:{lat:e.lat,lng:e.lng},map:t.map,icon:{url:r,scaledSize:new google.maps.Size(32,32)}});console.log(t.trashcan),marker.addListener("click",(function(){var n=new google.maps.InfoWindow({maxWidth:350}),r=new c.default({render:function(t){return t(l.a,{props:{general:e.General,recycle:e.Recycle,lat:e.lat,lng:e.lng,tname:e.tname}})}});n.setContent(r.$mount().$el),n.open(t.map,marker),t.infowindow&&t.infowindow.close(),n.open(t.map,marker),t.infowindow=n}))}))},setGarbageMarker:function(){var t,e=[],n=A(this.trashcanList.trashcan);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.push({lat:r.lat,lng:r.lng})}}catch(t){n.e(t)}finally{n.f()}this.displayRoute(e)},displayRoute:function(t){for(var e=new google.maps.DirectionsService,n=new google.maps.DirectionsRenderer({map:this.map,suppressMarkers:!0}),r={travelMode:google.maps.TravelMode.DRIVING,waypoints:[],optimizeWaypoints:!0,origin:t[0],destination:t[t.length-1]},i=1;i<t.length-1;i++)r.waypoints.push({location:t[i],stopover:!0});e.route(r,(function(t,e){e===google.maps.DirectionsStatus.OK?n.setDirections(t):console.error("無法顯示路線："+e)}))},getCurrentLocation:function(){var t=this;return new Promise((function(e,n){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(r){var o=new google.maps.Geocoder,c=new google.maps.LatLng(r.coords.latitude,r.coords.longitude);o.geocode({location:c},(function(o,c){"OK"===c&&o[0]?(t.isNoMap=!1,t.currentLocation={lat:r.coords.latitude,lng:r.coords.longitude},e()):(console.log("無法獲取當前位置"),t.isNoMap=!0,n())}))}),(function(e){console.log("獲取位置失敗：",e),t.isNoMap=!0,n()})):(console.log("瀏覽器不支援 Geolocation API"),t.isNoMap=!0,n())}))},GetStaffTrashListApi:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("西屯區清潔人員");case 2:n=e.sent,t.trashcanList=n.data;case 4:case"end":return e.stop()}}),e)})))()}}},m=(n(1458),n(28)),component=Object(m.a)(d,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"GarbageTruckData"}},[e("div",{ref:"mapRef",staticClass:"google-map",attrs:{id:"mapStaff"}},[t.isNoMap?e("div",{staticClass:"img-mask"},[e("div",{staticClass:"img-text-big"},[t._v(t._s("沒有定位 沒有方向"))]),e("div",{staticClass:"img-text"},[t._v(t._s("*請開啟定位，並重整畫面*"))]),e("img",{attrs:{src:n(1323),alt:"logo"}})]):t._e()]),t.isNoMap?t._e():e("div",[t.loadingVisible?e("Loading"):t._e()],1)])}),[],!1,null,"dcb77a50",null);e.default=component.exports}}]);